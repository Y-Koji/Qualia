// Generated by CoffeeScript 1.12.3
(function() {
  var app, bodyParser, compression, connect, exec, fs, http, mkdirp, rooter, url;

  http = require('http');

  url = require('url');

  connect = require('connect');

  compression = require('compression');

  bodyParser = require('body-parser');

  rooter = require('./rooter.js');

  fs = require('fs');

  mkdirp = require('mkdirp');

  exec = require('child_process').exec;

  app = connect()
  .use(compression())
  //.use(bodyParser.urlencoded())
  .use(bodyParser.json())
  .use('/', function(req, res, next) {
    var obj;
    obj = url.parse(req.url, true);
    req.query = obj.query;
    return next();
  }).use('/', function(req, res, next) {
    req.url = decodeURIComponent(req.url);
    return next();
  });

  require('./api.js').set(app).use('/', function(req, res, next) {
    req.url = req.url.replace('/', '/htdocs/');
    return rooter(res, req.url);
  });

  module.exports = {
    http: http.createServer(app),
    chat: require('./chat.js')(require('socket.io')(http.createServer())),
    syncpad: require('./sync-pad.js')(require('socket.io')(http.createServer()))
  };

}).call(this);
